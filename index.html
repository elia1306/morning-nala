<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Good Morning Nala</title>
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&family=Barriecito&family=Caveat:wght@400;700&family=Fredoka:wght@400;600&family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        :root {
            /* ğŸ’œ K-Pop è‰²ç›¤ */
            --primary: #9b59b6;
            --primary-dark: #8e44ad;
            --neon-pink: #ff79c6;
            --neon-blue: #8be9fd;
            --bg-color: #f8f0fc;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #2c3e50;
            --gold: #f1c40f;
            
            /* é è¨­å­—å‹è®Šæ•¸ */
            --font-hand: 'Caveat', cursive;  /* å…§æ–‡èˆ‡æŒ‰éˆ• */
            --font-title: 'Barriecito', cursive; /* æ¨™é¡Œå›ºå®š */
        }

        body {
            font-family: var(--font-hand);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding-bottom: calc(20px + env(safe-area-inset-bottom));

            /* === èƒŒæ™¯è¨­å®š === */
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(155, 89, 182, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(255, 121, 198, 0.15) 0%, transparent 20%);
            /* background-image: url('bg.png'); */ /* è‡ªè¨‚èƒŒæ™¯è«‹è§£é–‹é€™è¡Œ */
            
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        header { 
            width: 100%; max-width: 500px;
            display: flex; flex-direction: column; align-items: center;
            margin-bottom: 20px;
        }

        h1 {
            font-family: var(--font-title);
            font-size: 3.2rem;
            color: var(--primary-dark);
            text-shadow: 3px 3px 0px var(--neon-pink);
            margin: 0 0 10px 0;
            letter-spacing: 1px;
            line-height: 1.1;
            text-align: center;
        }

        /* ğŸ“Š æ–°å¢ï¼šç‹€æ…‹åˆ— (æ˜Ÿæ˜Ÿèˆ‡æ™‚é˜ä¸¦æ’) */
        .status-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            width: 100%;
        }

        .stat-item {
            background: white;
            padding: 8px 18px;
            border-radius: 20px;
            font-family: 'Fredoka', sans-serif; /* æ•¸å­—ä¿æŒæ˜“è®€ */
            font-size: 1.2rem;
            display: flex; align-items: center; gap: 8px;
            box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
        }

        /* æ˜Ÿæ˜Ÿæ¨£å¼ */
        .stat-stars {
            border: 2px solid var(--gold);
            color: #f39c12;
        }

        /* æ™‚é˜æ¨£å¼ */
        .stat-clock {
            border: 2px solid var(--neon-pink);
            color: var(--primary);
        }

        .card {
            background: var(--card-bg);
            width: 100%; max-width: 500px;
            border-radius: 20px;
            padding: 25px 20px;
            margin-bottom: 20px;
            border: 3px solid var(--primary);
            box-shadow: 6px 6px 0px rgba(155, 89, 182, 0.2);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .task-list { list-style: none; padding: 0; margin: 0; }

        .task-item {
            font-size: 1.6rem;
            margin-bottom: 15px;
            padding: 8px;
            border-bottom: 2px dashed #ddd;
            display: flex; align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .task-item.special {
            background: #e8f4fd;
            border-radius: 10px;
            border-bottom: none;
            color: #2980b9;
        }

        .checkbox {
            width: 28px; height: 28px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            margin-right: 15px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
            background: white;
        }

        .task-item.checked { text-decoration: line-through; color: #aaa; }
        .task-item.checked .checkbox { background: var(--primary); }
        .task-item.checked .checkbox::after { content: 'âœ”'; color: white; font-size: 1.2rem; }

        .btn-ready {
            background: linear-gradient(135deg, var(--primary), var(--neon-pink));
            color: white;
            /* [ä¿®æ”¹] é€™è£¡æ”¹æˆä½¿ç”¨è®Šæ•¸ï¼Œæ‰€ä»¥æœƒè·Ÿè‘—é¸å–®æ”¹è®Š */
            font-family: var(--font-hand); 
            font-size: 2.2rem;
            border: none;
            padding: 15px 0;
            width: 100%; max-width: 500px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 var(--primary-dark);
            transition: transform 0.1s;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        .btn-ready:active { transform: translateY(6px); box-shadow: 0 0 0; }

        .weekly-stats {
            width: 100%; max-width: 500px;
            background: white;
            border-radius: 15px;
            padding: 15px 20px;
            margin-top: 25px;
            border: 2px solid var(--neon-blue);
            box-shadow: 4px 4px 0 rgba(139, 233, 253, 0.5);
            display: flex; justify-content: space-between; align-items: center;
        }
        .weekly-label { font-weight: bold; color: #555; font-size: 1.2rem; }
        .weekly-value { font-family: var(--font-title); font-size: 2.2rem; color: var(--primary); }

        .calendar-container {
            width: 100%; max-width: 500px;
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #ddd;
        }
        .cal-header { text-align: center; font-weight: bold; font-size: 1.3rem; margin-bottom: 15px; color: var(--primary-dark); }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        
        .cal-day {
            aspect-ratio: 1/1;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: #f9f9f9;
            border-radius: 8px;
            font-size: 1rem; color: #aaa;
            font-family: 'Fredoka', sans-serif;
        }
        
        .cal-day.done { background: #e1bee7; color: var(--primary-dark); border: 1px solid var(--primary); font-weight: bold; }
        .cal-day.perfect { background: var(--neon-pink); color: white; border: 1px solid #ff4081; box-shadow: 0 0 5px var(--neon-pink);}
        
        .cal-star-num { font-size: 0.7rem; margin-top: 2px; }
        .cal-day.today { border: 2px dashed var(--primary); }

        .footer-tools { 
            margin-top: 30px; 
            width: 100%; max-width: 500px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .reset-link { color: #ccc; text-decoration: underline; cursor: pointer; font-size: 0.9rem; font-family: sans-serif; }
        
        .font-selector {
            padding: 8px 12px;
            border: 2px solid var(--primary);
            border-radius: 12px;
            background: white;
            color: var(--primary-dark);
            font-family: var(--font-hand);
            font-size: 1.1rem;
            outline: none;
            cursor: pointer;
        }

        .result-overlay {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            align-items: center; justify-content: center;
            flex-direction: column;
        }
        .result-box {
            background: white; padding: 30px; border-radius: 20px; text-align: center;
            width: 90%; max-width: 400px;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .rank-badge { font-family: var(--font-title); font-size: 4rem; margin: 10px 0; }
        .rank-s { color: var(--gold); text-shadow: 2px 2px 0 #d35400; }
        .rank-a { color: var(--neon-pink); }
        .rank-b { color: var(--neon-blue); }
        .rank-c { color: #aaa; }
        
        .btn-close { 
            background: #333; color: white; border: none; padding: 10px 30px; 
            border-radius: 20px; font-size: 1.2rem; cursor: pointer; margin-top: 20px; font-family: var(--font-hand);
        }

        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 99; display: none; }

        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <header>
        <h1>Good Morning Nala</h1>
        
        <div class="status-bar">
            <div class="stat-item stat-stars">
                <span>â­</span>
                <span id="total-stars">0</span>
            </div>
            <div class="stat-item stat-clock">
                <span>â°</span>
                <span id="clock">--:--</span>
            </div>
        </div>
    </header>

    <div class="card" id="main-card">
        <ul class="task-list" id="task-list">
            <li class="task-item" onclick="toggleCheck(this)">
                <div class="checkbox"></div>
                <span>Toilet & Brush Teeth ğŸ›</span>
            </li>
            <li class="task-item" onclick="toggleCheck(this)">
                <div class="checkbox"></div>
                <span>Change Clothes ğŸ‘—</span>
            </li>
            <li class="task-item" onclick="toggleCheck(this)">
                <div class="checkbox"></div>
                <span>Breakfast & Bag ğŸ’</span>
            </li>
            <li class="task-item" onclick="toggleCheck(this)">
                <div class="checkbox"></div>
                <span>Chinese Medicine ğŸµ</span>
            </li>
            <li class="task-item" onclick="toggleCheck(this)">
                <div class="checkbox"></div>
                <span>Everything Ready! âœ¨</span>
            </li>
        </ul>
    </div>

    <button class="btn-ready" onclick="finishRoutine()">I'm Ready!</button>

    <div class="weekly-stats">
        <span class="weekly-label">Weekly Score</span>
        <span class="weekly-value" id="weekly-score">0 â­</span>
    </div>

    <div class="calendar-container">
        <div class="cal-header" id="cal-month-title">Calendar</div>
        <div class="cal-grid" id="cal-grid"></div>
    </div>

    <div class="footer-tools">
        <select id="font-selector" class="font-selector">
            <option value="'Caveat', cursive">Caveat (Default)</option>
            <option value="'Barriecito', cursive">Barriecito (Hearts!)</option>
            <option value="'Patrick Hand', cursive">Patrick Hand (Marker)</option>
            <option value="'Fredoka', sans-serif">Fredoka (Round)</option>
            <option value="'Amatic SC', cursive">Amatic SC (Tall)</option>
        </select>

        <span class="reset-link" onclick="clearData()">Reset Data</span>
    </div>

    <div class="result-overlay" id="result-overlay">
        <div class="result-box">
            <div id="result-rank" class="rank-badge">S</div>
            <h2 id="result-title">Perfect!</h2>
            <p id="result-desc" style="font-size: 1.2rem; color:#666;">+20 Stars</p>
            <p id="result-time" style="color:#aaa; margin-top:5px;">Time: 06:40</p>
            <button class="btn-close" onclick="location.reload()">See ya tomorrow!</button>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        const clockEl = document.getElementById('clock');
        const taskList = document.getElementById('task-list');
        const totalStarsEl = document.getElementById('total-stars');
        const weeklyScoreEl = document.getElementById('weekly-score');
        const calGrid = document.getElementById('cal-grid');
        const calTitle = document.getElementById('cal-month-title');
        const resultOverlay = document.getElementById('result-overlay');
        const fontSelector = document.getElementById('font-selector');
        
        checkTuesday();
        loadData();
        loadFont(); // è¼‰å…¥å­—å‹è¨­å®š
        
        setInterval(() => {
            const now = new Date();
            clockEl.textContent = now.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute:'2-digit' });
        }, 1000);

        // å­—å‹åˆ‡æ›é‚è¼¯
        fontSelector.addEventListener('change', (e) => {
            const newFont = e.target.value;
            document.documentElement.style.setProperty('--font-hand', newFont);
            localStorage.setItem('hunter_font_v2', newFont); 
        });

        function loadFont() {
            const savedFont = localStorage.getItem('hunter_font_v2');
            if (savedFont) {
                document.documentElement.style.setProperty('--font-hand', savedFont);
                fontSelector.value = savedFont;
            }
        }

        function toggleCheck(el) {
            el.classList.toggle('checked');
        }

        function checkTuesday() {
            const now = new Date();
            if (now.getDay() === 2) { 
                const li = document.createElement('li');
                li.className = 'task-item special';
                li.setAttribute('onclick', 'toggleCheck(this)');
                li.innerHTML = `<div class="checkbox"></div><span>Swimsuit ğŸ©± (Tue)</span>`;
                const items = taskList.children;
                taskList.insertBefore(li, items[items.length - 2]);
            }
        }

        function finishRoutine() {
            const now = new Date();
            const target645 = new Date(); target645.setHours(6, 45, 0);
            const target650 = new Date(); target650.setHours(6, 50, 0);
            const target651 = new Date(); target651.setHours(6, 51, 0);
            
            let stars = 0;
            let rank = "";
            let title = "";
            let rankClass = "";

            if (now < target645) {
                stars = 20; rank = "S"; title = "GODLIKE!"; rankClass = "rank-s";
            } else if (now < target650) {
                stars = 15; rank = "A"; title = "Amazing!"; rankClass = "rank-a";
            } else if (now < target651) {
                stars = 10; rank = "B"; title = "Good Job!"; rankClass = "rank-b";
            } else {
                stars = 0; rank = "C"; title = "Try Again!"; rankClass = "rank-c";
            }

            document.getElementById('result-rank').textContent = rank;
            document.getElementById('result-rank').className = "rank-badge " + rankClass;
            document.getElementById('result-title').textContent = title;
            document.getElementById('result-desc').textContent = `+${stars} Stars`;
            document.getElementById('result-time').textContent = `Finished at ${now.toLocaleTimeString('en-US', {hour12:false, hour:'2-digit', minute:'2-digit'})}`;
            
            resultOverlay.style.display = 'flex';
            if (stars > 0) startConfetti();

            saveDailyData(stars);
        }

        function saveDailyData(stars) {
            const today = new Date();
            const dateKey = `${today.getFullYear()}-${today.getMonth() + 1}-${today.getDate()}`;
            let data = JSON.parse(localStorage.getItem('hunter_data') || "{}");
            data[dateKey] = { stars: stars };
            localStorage.setItem('hunter_data', JSON.stringify(data));
            loadData();
        }

        function loadData() {
            const data = JSON.parse(localStorage.getItem('hunter_data') || "{}");
            const now = new Date();
            
            // Total Stars
            let total = 0;
            Object.values(data).forEach(day => total += (day.stars || 0));
            totalStarsEl.textContent = total;

            // Weekly Stats
            let weeklyTotal = 0;
            const dayOfWeek = now.getDay(); 
            const sunday = new Date(now);
            sunday.setDate(now.getDate() - dayOfWeek); 
            
            for (let i = 0; i < 7; i++) {
                let d = new Date(sunday);
                d.setDate(sunday.getDate() + i);
                const k = `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`;
                if (data[k]) weeklyTotal += data[k].stars;
            }
            weeklyScoreEl.textContent = weeklyTotal + " â­";

            renderCalendar(data);
        }

        function renderCalendar(data) {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            document.getElementById('cal-month-title').textContent = `${now.toLocaleString('default', { month: 'long' })} ${year}`;
            
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDayIndex = new Date(year, month, 1).getDay(); 
            
            let html = '';
            for(let i=0; i<firstDayIndex; i++) html += `<div></div>`;
            
            for(let d=1; d<=daysInMonth; d++) {
                const k = `${year}-${month + 1}-${d}`;
                const record = data[k];
                const isToday = (d === now.getDate());
                let cls = 'cal-day';
                let content = d;
                
                if (isToday) cls += ' today';
                if (record) {
                    if (record.stars >= 20) {
                        cls += ' perfect'; 
                        content = `${d}<div class="cal-star-num">ğŸ‘‘${record.stars}</div>`;
                    } else {
                        cls += ' done';
                        content = `${d}<div class="cal-star-num">â­${record.stars}</div>`;
                    }
                }
                html += `<div class="${cls}">${content}</div>`;
            }
            calGrid.innerHTML = html;
        }

        function clearData() {
            if(confirm("Delete all history?")) {
                localStorage.removeItem('hunter_data');
                location.reload();
            }
        }

        function startConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            canvas.style.display = 'block';
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const pieces = [];
            const colors = ['#9b59b6', '#ff79c6', '#f1c40f', '#8be9fd'];
            for (let i = 0; i < 150; i++) {
                pieces.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 8 + 4,
                    speed: Math.random() * 4 + 2,
                    rotation: Math.random() * 360
                });
            }
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                pieces.forEach(p => {
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.rotation * Math.PI / 180);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
                    ctx.restore();
                    p.y += p.speed; p.rotation += p.speed * 2;
                    if (p.y > canvas.height) p.y = -20;
                });
                requestAnimationFrame(draw);
            }
            draw();
            setTimeout(() => canvas.style.display = 'none', 5000);
        }
    </script>
</body>
</html>
